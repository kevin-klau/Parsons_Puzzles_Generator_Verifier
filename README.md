 # Parsons Big-O Puzzle Verifier (Lean4)

 This repository is a proof-of-concept for generating Parsons puzzles about Big-O time complexity proofs, and exporting Lean4 code to verify whether a proposed block ordering forms a correct proof.

 ## What this repo does

 - Stores one Parsons puzzle in `Verifier/puzzle.json`.
 - Exports three files into the same `Verifier/` folder:
   - `Question.txt` (the question statement)
   - `Blocks.txt` (plain-English Parsons blocks for students)
   - `Main.lean` (Lean4 code assembled from the selected block order)

 Lean is used as the “ground truth” checker: if the proof compiles and ends with “No goals”, then the block ordering is correct.

 ## Key idea

 This is a rough proof of concept that could be automated to generate an infinite amount of problems and solutions, but the following steps are manual:

 1. `cd` to the folder `./Verifier`

 2. Copy the prompt from `prompt.txt` into your choice of generative AI
    (currently tested with **ChatGPT 5.2 Thinking**).

 3. Paste the AI’s JSON output into `puzzle.json` (overwrite the existing contents).

 4. Run the exporter script (from inside `./Verifier`):

    `python parsons_export.py --json puzzle.json`

    Optional: if you want to force a specific block ordering in the generated Lean proof (Note: Do not add spaces in the order, keep it "B1,B2,B3" etc.):

    `python parsons_export.py --json puzzle.json --order B1,B2,B3,B4`

 5. After running the script, you should see:
    - `Blocks.txt` → the Parsons puzzle blocks (plain English, ready to shuffle)
    - `Question.txt` → the question statement
    - `Main.lean` → the Lean4 proof generated from the selected order (default or specified)

 6. To check whether the Parsons puzzle + proof is correct, open `Main.lean` in VS Code and open **Lean InfoView**:
    - If this is your first time opening Lean, it may take a while to start the Lean server.
    - If the proof is correct, you should eventually see **“No goals”** at the end.
    - If the proof is incorrect (or the block order is wrong), Lean will show an error at the first failing line.

 ## Files you will edit most

 - `Verifier/prompt.txt`
   - The prompt you paste into a generative AI to produce a new puzzle JSON.

 - `Verifier/puzzle.json`
   - The generated puzzle in JSON format (question + English blocks + Lean snippets).

 ## Files generated by the script

 - `Verifier/Question.txt`
   - Printable question statement.

 - `Verifier/Blocks.txt`
   - Printable Parsons blocks (English). These are intended to be shuffled.

 - `Verifier/Main.lean`
   - Lean4 proof file produced from the chosen block ordering.

 ## Exporter usage

 From inside `./Verifier`:

 - Default behaviour (generates Question.txt, Blocks.txt, Main.lean; uses default order):
   `powershell |   python parsons_export.py --json puzzle.json |   `

 - Specify a block order explicitly:
   `powershell |   python parsons_export.py --json puzzle.json --order B1,B2,B3,B4 |   `

 ## Notes / troubleshooting

 - If `python parsons_export.py --json puzzle.json` fails with a “file not found” error for the outputs, make sure you are running the command from inside the `Verifier` folder, and that the script defaults are set to output `Question.txt`, `Blocks.txt`, and `Main.lean` in the current folder.

 - If VS Code shows `unknown module prefix 'Mathlib'` in `Main.lean`, your Lean project is missing Mathlib. Open the repository root in VS Code and run (from the repo root):

   `powershell |   lake update |   lake exe cache get |   lake build |   `

   Then restart the Lean server (VS Code: “Lean: Restart File”).
